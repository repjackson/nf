template(name='product_view')
    with current_doc
        .ui.stackable.grid
            .two.column.row
                .column
                    a.ui.basic.circular.button(href="/shop")
                        i.chevron.left.icon
                        +i name='food' cl='ui mini inline image'
                
                    .ui.large.inline.header 
                        //- small viewing
                        | #{title}
                        //- small product
                    if can_edit
                        a(href="/product/#{_id}/edit")
                            i.pencil.blue.large.link.circular.icon
                    a(href="{{c.url image_id}}" target="_window")
                        img.ui.rounded.fluid.image.zoomer(src="{{c.url image_id}}")
                    div
                    +voting_full
                    div 
                    +comments
                .column.scrolling
                    if can_order
                        +order_button
                    .ui.inline.header 
                        +i name='ingredients'
                        |ingredients
                    each ingredients
                        .ui.large.basic.label #{this}
                    +boolean_view key='gluten_free' label='gluten free' direct=true
                    +boolean_view key='vegan' label='vegan' direct=true
                    .ui.header #{menu_section}
                    +html_view key='description' direct=true
                    .ui.header 
                        +i name='order-history'
                        |#{product_orders.count}
                        |orders
                        |(${{fixed product_order_total}})
                    .ui.basic.segments.scrolling
                        each product_orders
                            +product_order_card
                    .ui.header #{views} views
                    .ui.hidden.divider
         
         
         
         
template(name='product_order_card')
    .ui.segment(class=product_order_class)
        .ui.inline.green.header
            |${{fixed order_price}} 
            if _author.image_id
                img.ui.avatar.image(src="{{c.url _author.image_id width=100 height=100 gravity='face' crop='fill'}}")
            |#{_author.username}
        // div
        .ui.large.basic.label
            i.clock.icon
            |status: #{status}
        .ui.small.inline.header
            | #{when} ({{long_date _timestamp}})
        a.ui.compact.big.icon.button(href="/order/#{_id}")
            i.right.chevron.large.icon
        if is_author
            .ui.small.compact.basic.button.cancel_order(title='cancel')
                i.remove.red.icon
                |cancel



template(name='order_button')
    // if servings_left
    .ui.green.fluid.large.circular.button.order_product
        i.cart.plus.large.icon
        strong ${{fixed price_usd}}
        // |order #{serving_unit}
        // small order for
        // strong #{price_franc}f
    // else 
    //     .ui.grey.header sold out
        //- .ui.teal.large.fluid.button.join_waitlist
        //-     i.clock.large.icon
        //-     |join wait list
